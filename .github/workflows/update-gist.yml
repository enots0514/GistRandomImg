name: Update Gist Image Daily
on:
  schedule:
    - cron: '0 0 * * *' # 매일 자정
  workflow_dispatch: # 수동 실행 버튼

jobs:
  update-gist:
    runs-on: ubuntu-latest
    steps:
      - name: Update Gist via API
        run: |
          # 1. 랜덤 숫자 생성
          RANDOM_NUM=$((1 + RANDOM % 1000))
          
          # 2. 지스트에 들어갈 새로운 내용 (여기에 본인의 이미지 코드를 넣으세요)
          # 주의: 따옴표 처리를 위해 큰따옴표 앞에 역슬래시(\")를 붙였습니다.
          CONTENT="<a href='https://github.com'><img src='https://picsum.photos/150/100.webp?random=$RANDOM_NUM' alt='Random Image'></a>"

          # 3. 깃허브 API를 사용해 지스트 파일 내용 교체
          curl -L \
            -X PATCH \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GIST_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/gists/${{ secrets.GIST_ID }} \
            -d "{\"files\":{\"key.md\":{\"content\":\"$CONTENT\"}}}"
